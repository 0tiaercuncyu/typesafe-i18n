// This types were auto-generated. Any manual changes will be overwritten.
/* eslint-disable */

import { langaugeObjectWrapper } from 'langauge';
import type { Readable, Writable } from 'svelte/store';
import { derived, writable } from 'svelte/store';
import type { LangaugeLocale, LangaugeTranslation, LangaugeTranslationArgs, LangaugeTranslationKeys } from './svelte-async/types.actual.output'
import { getTranslationForLocale } from './svelte-async/util.actual.output'
import { initFormatters } from './svelte-async/formatters-template.actual.output'

const currentLocale = writable<LangaugeLocale>('' as LangaugeLocale)

const isLoading = writable<boolean>(true)

let langaugeInstance = new Proxy({} as LangaugeTranslationArgs, { get: (_target, key: LangaugeTranslationKeys) => () => key })

const langaugeInstanceStore = writable<LangaugeTranslationArgs>(langaugeInstance)

export const initLangauge = (newlocale: LangaugeLocale = 'en') => setLocale(newlocale)

export const setLocale = async (newlocale: LangaugeLocale) => {
	if (!newlocale) return

	isLoading.set(true)

	const langaugeTranslation: LangaugeTranslation = await getTranslationForLocale(newlocale)
	langaugeInstance = langaugeObjectWrapper(newlocale, langaugeTranslation, initFormatters(newlocale))
	langaugeInstanceStore.set(langaugeInstance)

	currentLocale.set(newlocale)

	isLoading.set(false)
}

export const locale = derived<Writable<LangaugeLocale>, LangaugeLocale>(currentLocale, (newlocale) => newlocale)

export const isLoadingLocale = derived<Writable<boolean>, boolean>(isLoading, (loading: boolean, set: (value: boolean) => void) => set(loading))

export const LL = new Proxy({} as Readable<LangaugeTranslationArgs> & LangaugeTranslationArgs, {
	get: (_target, key: LangaugeTranslationKeys & 'subscribe') => key === 'subscribe'
		? langaugeInstanceStore.subscribe
		: langaugeInstance[key]
})

export default LL
